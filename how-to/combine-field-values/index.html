<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Combine field values - Headfake</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  <link href="//use.fontawesome.com/releases/v5.8.1/css/all.css" rel="stylesheet" />
  <link href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css" rel="stylesheet" />
  <link href="../../css/mkapi-common.css" rel="stylesheet" />
  <link href="../../css/mkapi-readthedocs.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Combine field values";
    var mkdocs_page_input_path = "how-to/combine-field-values.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Headfake</a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../usage/">Usage</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tutorials</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorial1/">1. Generating fake data files</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorial2/">2. Changing Headfake template files</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorial3/">3. Adding conditional fields</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Discussion</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../discussion/initialising-headfake/">Initialising Headfake</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">How to..</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../create-custom-fields/">Create custom fields</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../create-custom-transformers/">Create custom transformers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../add-a-lookup-field/">Add a lookup field</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../generate-identical-datasets/">Generate identical datasets</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../exclude-fields-from-the-output/">Exclude fields from the output</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Combine field values</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#example-1-length_of_stay-setup-as-a-separate-field-and-included-in-the-data-set">Example 1 - 'length_of_stay' setup as a separate field and included in the data set:</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example-2-length-of-stay-embedded-within-the-discharge_date-field-so-it-is-not-available-separately">Example 2 - length of stay embedded within the 'discharge_date' field so it is not available separately</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">API</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/headfake/">headfake</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">field</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../api/field/core/">core</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/field/id/">id</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/field/faker/">faker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../api/field/derived/">derived</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/cli/">cli</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/fieldset/">fieldset</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/transformer/">transformer</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/output/">output</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/error/">error</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../api/util/">util</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Headfake</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>How to.. &raquo;</li>
        
      
    
    <li>Combine field values</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/rcfgroup/headfake/edit/master/docs/how-to/combine-field-values.md"> Edit on headfake</a>
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="combine-field-values">Combine field values</h1>
<p>Operation fields enable you to generate data by combining values from two fields using a specified function.
For example, you could use an operation field to add, subtract or multiply generated values together. When operation fields are used it is best to use field lists rather than field maps
as this ensures the correct order of field generation.</p>
<p>In general, functions in Python's operator package are used, but you can actually specify any function (including your own) which accepts two input values and returns a single output value.</p>
<p>The examples below shows how this can be used to generate a hospital discharge date based on the admission date and a generated length of stay.</p>
<h2 id="example-1-length_of_stay-setup-as-a-separate-field-and-included-in-the-data-set">Example 1 - 'length_of_stay' setup as a separate field and included in the data set:</h2>
<div class="codehilite"><pre><span></span><code><span class="nt">fieldset</span><span class="p">:</span>
  <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.Fieldset</span>
  <span class="nt">fields</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">admission_date</span>
      <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.DateField</span>
      <span class="nt">min</span><span class="p">:</span> <span class="s">&quot;2020-01-01&quot;</span>
      <span class="nt">max</span><span class="p">:</span> <span class="s">&quot;2020-12-31&quot;</span>
      <span class="nt">distribution</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scipy.stats.norm</span>
      <span class="nt">mean</span><span class="p">:</span> <span class="s">&quot;2020-06-01&quot;</span>
      <span class="nt">sd</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
      <span class="nt">min_format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>
      <span class="nt">max_format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>
      <span class="nt">mean_format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">length_of_stay</span>
      <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.NumberField</span>
      <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18</span>
      <span class="nt">max</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
      <span class="nt">distribution</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scipy.stats.norm</span>
      <span class="nt">mean</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
      <span class="nt">sd</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
      <span class="nt">dp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>

      <span class="nt">transformers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.transformer.ConvertToDaysDelta</span>

      <span class="nt">final_transformers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.transformer.GetProperty</span>
        <span class="nt">prop_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">days</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">discharge_date</span>
      <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.OperationField</span>
      <span class="nt">operator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">operator.add</span>
      <span class="nt">first_value</span><span class="p">:</span>
        <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.LookupField</span>
        <span class="nt">field</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">admission_date</span>

      <span class="nt">second_value</span><span class="p">:</span>
        <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.LookupField</span>
        <span class="nt">field</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">length_of_stay</span>

      <span class="nt">final_transformers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.transformer.FormatDateTime</span>
        <span class="nt">format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>
</code></pre></div>

<h2 id="example-2-length-of-stay-embedded-within-the-discharge_date-field-so-it-is-not-available-separately">Example 2 - length of stay embedded within the 'discharge_date' field so it is not available separately</h2>
<div class="codehilite"><pre><span></span><code><span class="nt">fieldset</span><span class="p">:</span>
  <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.Fieldset</span>
  <span class="nt">fields</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">admission_date</span>
      <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.DateField</span>
      <span class="nt">min</span><span class="p">:</span> <span class="s">&quot;2020-01-01&quot;</span>
      <span class="nt">max</span><span class="p">:</span> <span class="s">&quot;2020-12-31&quot;</span>
      <span class="nt">distribution</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scipy.stats.norm</span>
      <span class="nt">mean</span><span class="p">:</span> <span class="s">&quot;2020-06-01&quot;</span>
      <span class="nt">sd</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">30</span>
      <span class="nt">min_format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>
      <span class="nt">max_format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>
      <span class="nt">mean_format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>

    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">discharge_date</span>
      <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.OperationField</span>
      <span class="nt">operator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">operator.add</span>
      <span class="nt">first_value</span><span class="p">:</span>
        <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.LookupField</span>
        <span class="nt">field</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">admission_date</span>

      <span class="nt">second_value</span><span class="p">:</span>
        <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.field.NumberField</span>
        <span class="nt">min</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">18</span>
        <span class="nt">max</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
        <span class="nt">distribution</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scipy.stats.norm</span>
        <span class="nt">mean</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">50</span>
        <span class="nt">sd</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">15</span>
        <span class="nt">dp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0</span>
        <span class="nt">transformers</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.transformer.ConvertToDaysDelta</span>

      <span class="nt">final_transformers</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">headfake.transformer.FormatDateTime</span>
        <span class="nt">format</span><span class="p">:</span> <span class="s">&quot;%Y-%m-%d&quot;</span>
</code></pre></div>

<p>In both examples, the 'admission_date' field is a straightforward date field - it generates dates which follow a normal distribution.
The 'discharge_date' is more complex. It is an OperationField  which receives two values. In Example 1 the value is a look up in the separate 'length_of_stay' field while in Example 2 the value
is generated within the OperationField. In both cases, the length of stay is a random number which follows a normal distribution.</p>
<p>The same effect (ie. not including the length of stay field in the output could also have been achieved in Example 1 by adding a <code>hidden = true</code> property to the 'length_of_stay' field.</p>
<p>The length of stay is then converted into a Python timedelta object using a transformer and through the OperationField is added to the 'admission_date'.</p>
<p>The critical thing within the operation is that the value types (e.g. objects) need to be compatible with the operation function - this is why it was necessary to convert the numeric length of stay into a timedelta object as this can be added to a date object using <code>operator.add</code> (<code>operator.add(value1, value2)</code> is equivalent to <code>value1 + value2</code>).</p>
<p>Headfake comes with a number of conversion transformers which will change values into dates, numbers or strings and it is straightforward to <a href="../create-custom-transformers/">create custom transformers</a> to do this.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../api/headfake/" class="btn btn-neutral float-right" title="headfake">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../exclude-fields-from-the-output/" class="btn btn-neutral" title="Exclude fields from the output"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../exclude-fields-from-the-output/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../api/headfake/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../js/mkapi.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
